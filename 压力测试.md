## 压力测试

### 测试环境

+ 系统： Ubuntu 20.04
+ 内存：16G
+ CPU：Intel(R) Core(TM) i7-12650H

### 测试方法

+ 参考林亚的测试方法 https://github.com/linyacool/WebServer/blob/master/%E6%B5%8B%E8%AF%95%E5%8F%8A%E6%94%B9%E8%BF%9B.md

+ 分为本地测试和网络测试，网络测试时为两台处于同一局域网内的计算机，网卡速度限制是1000Mbps
+ 使用工具Webbench，开启1000个客户端，时间60秒
+ 分别测试长连接和短连接，关闭日志输出
+ 为避免磁盘IO对结果的影响，测试响应为内存中的一段字符
+ 服务器线程池开启4线程

### 测试结果

|  环境  | 短连接QPS | 长连接QPS |
| :----: | :-------: | :-------: |
|  本地  |   83110   |  184384   |
| 局域网 |   18739   |   38696   |

+ 短连接测试（本地）

![](/home/huangchen/Project/myWebServer/image/本地短连接结果.png)	

![](/home/huangchen/Project/myWebServer/image/本地短连接负载.png)	

​	

+ 短连接测试（局域网）

![](/home/huangchen/Project/myWebServer/image/局域网短连接结果.png)	

![](/home/huangchen/Project/myWebServer/image/局域网短连接负载.png)	



+ 长连接测试（本地）

  这里显示为负了，应该是webbench数值溢出了，不过不影响

![](/home/huangchen/Project/myWebServer/image/本地长连接结果.png)	

![](/home/huangchen/Project/myWebServer/image/本地长连接负载.png)	



+ 长连接测试（局域网）

![](/home/huangchen/Project/myWebServer/image/局域网长连接结果.png)	

![](/home/huangchen/Project/myWebServer/image/局域网长连接负载.png)	



### 结果分析

+ 可以看到处理能力是 本地 > 局域网， 长连接 > 短连接
+ 各个工作线程的负载均匀，日志线程开销很小
+ 长连接时主线程的负载比短连接时小，因为不需要频繁处理连接请求